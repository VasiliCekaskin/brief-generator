(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1136)}])},1136:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return v}});var r=t(4051),a=t.n(r),l=t(5893),i=t(8065),s=t(8193);function o(e,n,t,r,a,l,i){try{var s=e[l](i),o=s.value}catch(c){return void t(c)}s.done?n(o):Promise.resolve(o).then(r,a)}var c=function(e){var n=e.uploadHandler,t=function(){var e,t=(e=a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.target.files,n(r);case 2:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,a){var l=e.apply(n,t);function i(e){o(l,r,a,i,s,"next",e)}function s(e){o(l,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,l.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,l.jsx)("input",{onChange:t,className:"hidden",accept:".xls,.xlsx,.docx",id:"contained-button-file",multiple:!0,type:"file",name:"files"}),(0,l.jsx)(i.Z,{startIcon:(0,l.jsx)(s.IEK,{size:32}),className:"rounded-full p-6 pr-48 pl-48 bg-orange-500 hover:bg-orange-400 text-base font-bold",size:"large",variant:"contained",component:"span",children:"Dateien ausw\xe4hlen"})]})},d=t(9669),u=t.n(d),f=function(e){if(e.length>2)throw new Error("Du darfst nur eine Excel Datei und eine Word Datei hochladen!");for(var n=null,t=null,r=0;r<e.length;r++){var a=e.item(r);(null===a||void 0===a?void 0:a.name.endsWith(".xlsx"))||(null===a||void 0===a?void 0:a.name.endsWith(".xls"))?n=a:((null===a||void 0===a?void 0:a.name.endsWith(".docx"))||(null===a||void 0===a?void 0:a.name.endsWith(".doc")))&&(t=a)}if(!n)throw new Error("Bitte w\xe4hle jeweils eine Excel und Word Datei aus.");if(!t)throw new Error("Bitte w\xe4hle jeweils eine Excel und Word Datei aus.");return{excelFile:n,docxFile:t}},h=t(7294),x=t(6882);function p(e,n,t,r,a,l,i){try{var s=e[l](i),o=s.value}catch(c){return void t(c)}s.done?n(o):Promise.resolve(o).then(r,a)}var v=function(){var e=(0,h.useState)(null),n=e[0],t=e[1],r=(0,h.useState)(),i=r[0],s=r[1],o=function(){var e,n=(e=a().mark((function e(n){var r,l,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(null),!n){e.next=11;break}r=new FormData,l=null,i=null;try{o=f(n),l=o.excelFile,i=o.docxFile}catch(h){a=h,(null!=(d=Error)&&"undefined"!==typeof Symbol&&d[Symbol.hasInstance]?d[Symbol.hasInstance](a):a instanceof d)&&t(h.message)}return l&&i&&(r.append("excelFile",l,l.name),r.append("docxFile",i,i.name)),e.next=9,u().post("http://localhost:4040/generate-documents",r,{headers:{"Content-Type":"multipart/form-data"}});case 9:c=e.sent,s(c.data.downloadLink);case 11:case"end":return e.stop()}var a,d}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,a){var l=e.apply(n,t);function i(e){p(l,r,a,i,s,"next",e)}function s(e){p(l,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return(0,l.jsxs)("div",{className:"pt-24 flex flex-col space-y-12 items-center bg-orange-50",children:[(0,l.jsx)("p",{className:"text-xl mb-12",children:"Ganz einfach und schnell hunderte Briefe generieren lassen."}),n?(0,l.jsx)("p",{className:"text-red-600",children:n}):null,(0,l.jsx)(c,{uploadHandler:o}),i?(0,l.jsx)(x.Z,{href:i,children:"Download"}):null,(0,l.jsx)("p",{className:"text-xl mb-12 font-bold",children:"Wie funktionierts?"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 w-2/3 h-96",children:[(0,l.jsx)("div",{className:"flex flex-row space-x-2",children:(0,l.jsx)("p",{className:"text-base",children:"1: Erstelle eine Excel datei mit mit folgenden Spalten."})}),(0,l.jsx)("div",{className:"flex flex-row space-x-2",children:(0,l.jsx)("p",{className:"text-base",children:"2: Erstelle eine Word Datei mit den Spalten."})}),(0,l.jsx)("div",{className:"flex flex-row space-x-2",children:(0,l.jsx)("p",{className:"text-base",children:"3: Lade beide Dateien hoch und dr\xfccke auf herunterladen."})})]})]})}}},function(e){e.O(0,[617,618,774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);